# ç”Ÿæˆå¼å¯¹æŠ—ç½‘ç»œ (GAN)

## åŸºæœ¬åŸç†ä¸æ¶æ„

ç”Ÿæˆå¼å¯¹æŠ—ç½‘ç»œ (GANs) æ˜¯ä¸€ç§åŸºäºå¯å¾®ç”Ÿæˆå™¨ç½‘ç»œçš„ç”Ÿæˆå¼å»ºæ¨¡æ–¹æ³•ã€‚å®ƒåŸºäºåšå¼ˆè®ºåœºæ™¯ï¼Œå…¶ä¸­ç”Ÿæˆå™¨ç½‘ç»œä¸åˆ¤åˆ«å™¨ç½‘ç»œç«äº‰ã€‚

- **ç”Ÿæˆå™¨ç½‘ç»œ**ï¼šç›´æ¥äº§ç”Ÿæ ·æœ¬ $\boldsymbol{x} = G(\boldsymbol{z}; \boldsymbol{\theta}^{(g)})$ã€‚$\boldsymbol{z}$ è¡¨ç¤ºè¾“å…¥åˆ°ç”Ÿæˆå™¨ç½‘ç»œçš„éšæœºå™ªå£°ï¼Œä»å…ˆéªŒå™ªå£°åˆ†å¸ƒ$p_z(\boldsymbol{z})$ä¸­é‡‡æ ·å¾—åˆ°ã€‚
- **åˆ¤åˆ«å™¨ç½‘ç»œ**ï¼šè¯•å›¾åŒºåˆ†ä»è®­ç»ƒæ•°æ®å’Œç”Ÿæˆå™¨æŠ½å–çš„æ ·æœ¬ï¼Œè¾“å‡ºæ¦‚ç‡å€¼ $D(\boldsymbol{x}; \boldsymbol{\theta}^{(d)})$ï¼ŒæŒ‡ç¤º $\boldsymbol{x}$ æ˜¯çœŸå®è®­ç»ƒæ ·æœ¬è€Œä¸æ˜¯ä¼ªé€ æ ·æœ¬çš„æ¦‚ç‡ã€‚

## å­¦ä¹ è¿‡ç¨‹

GANs çš„å­¦ä¹ é€šè¿‡é›¶å’Œæ¸¸æˆçš„å½¢å¼åŒ–è¡¨ç¤ºï¼Œå…¶ä¸­åˆ¤åˆ«å™¨çš„æ”¶ç›Šå‡½æ•°ä¸º $v(G, D)$ï¼Œç”Ÿæˆå™¨çš„æ”¶ç›Šä¸º $-v(G, D)$ã€‚å­¦ä¹ çš„ç›®æ ‡æ˜¯æ‰¾åˆ°ä½¿ç”Ÿæˆå™¨æœ€ä¼˜çš„åˆ¤åˆ«å™¨ $G^* = \arg\min_{G} \max_{D} v(G, D)$ã€‚$v$ çš„é»˜è®¤é€‰æ‹©å¦‚ä¸‹ï¼š

$$v(G, D)=\mathbb{E}_{\boldsymbol x \sim p_{\text{data}}(x)} \log D(\boldsymbol x) + \mathbb{E}_{\boldsymbol z \sim p_z(\boldsymbol z)} (\log(1 - D(G(\boldsymbol z)))$$ 

æˆ–$$v(G, D)=\mathbb{E}_{\boldsymbol x \sim p_{\text{data}}} \log D(\boldsymbol x) + \mathbb{E}_{\boldsymbol x \sim p_{model}} (\log(1 - D(\boldsymbol x)))$$ 

ä¸Šå¼å®šä¹‰äº†ä¸€ä¸ªåšå¼ˆè¿‡ç¨‹ï¼Œå…¶ä¸­åˆ¤åˆ«å™¨çš„ç›®æ ‡æ˜¯æœ€å¤§åŒ–å…¶æ­£ç¡®åˆ†ç±»çœŸå®å’Œä¼ªé€ æ ·æœ¬çš„æ¦‚ç‡ï¼Œè€Œç”Ÿæˆå™¨çš„ç›®æ ‡æ˜¯æ¬ºéª—åˆ¤åˆ«å™¨ï¼Œä½¿å…¶å°†ç”Ÿæˆçš„æ ·æœ¬è¯¯è®¤ä¸ºçœŸå®æ ·æœ¬ã€‚åœ¨ç†æƒ³æƒ…å†µä¸‹ï¼Œæ”¶æ•›æ—¶ç”Ÿæˆå™¨çš„æ ·æœ¬ä¸å®é™…æ•°æ®ä¸å¯åŒºåˆ†ï¼Œåˆ¤åˆ«å™¨è¾“å‡º $\frac{1}{2}$ã€‚

## è®­ç»ƒè¿­ä»£

æ¯æ¬¡è¿­ä»£ï¼Œæ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼š

- è®­ç»ƒ $k$ æ¬¡åˆ¤åˆ«å™¨ï¼ˆå…¶ä¸­ $k$ æ˜¯ä¸€ä¸ªè¶…å‚æ•°ï¼Œé€šå¸¸è®¾ç½®ä¸º 1ï¼‰ï¼š
  - ä»å™ªå£°å…ˆéªŒ $p_g(\boldsymbol ğ‘§)$ ä¸­é‡‡æ · $m$ ä¸ªå™ªå£°æ ·æœ¬ ${\boldsymbol ğ‘§(1),â€¦,\boldsymbol ğ‘§(ğ‘š)}$ã€‚
  - ä»æ•°æ®ç”Ÿæˆåˆ†å¸ƒ $p_{data}(\boldsymbol x)$ ä¸­é‡‡æ · $m$ ä¸ªçœŸå®æ ·æœ¬ $\{\boldsymbol ğ‘¥(1),â€¦,\boldsymbolğ‘¥(ğ‘š)\}$ã€‚
  - æ›´æ–°åˆ¤åˆ«å™¨çš„å‚æ•° $ğœƒ^{(ğ‘‘)}$ï¼Œé€šè¿‡æ¢¯åº¦ä¸Šå‡æ¥æœ€å¤§åŒ–å…¶æŸå¤±å‡½æ•°ï¼š $âˆ‡_{ğœƒ^{(ğ‘‘)}}\frac{1}{ğ‘š}âˆ‘_{ğ‘–=1}^ğ‘š[logâ¡ğ·(ğ‘¥^{(ğ‘–)})+logâ¡(1âˆ’ğ·(ğº(ğ‘§^{(ğ‘–)})))]$
- è®­ç»ƒ1æ¬¡ç”Ÿæˆå™¨ï¼š
  - ä»å™ªå£°å…ˆéªŒ $p_g(\boldsymbol ğ‘§)$ ä¸­é‡‡æ · $m$ ä¸ªå™ªå£°æ ·æœ¬ ${\boldsymbol ğ‘§(1),â€¦,\boldsymbol ğ‘§(ğ‘š)}$ã€‚
  - æ›´æ–°ç”Ÿæˆå™¨çš„å‚æ•° $ğœƒ^{(ğ‘”)}$ï¼Œé€šè¿‡æ¢¯åº¦ä¸‹é™æ¥æœ€å°åŒ–å…¶æŸå¤±å‡½æ•°ï¼š $âˆ‡_{ğœƒ^{(ğ‘”)}}\frac{1}{ğ‘š}âˆ‘_{ğ‘–=1}^ğ‘šlogâ¡(1âˆ’ğ·(ğº(\boldsymbol ğ‘§^{(ğ‘–)})))$ã€‚

## ä»£ç æ¡ˆä¾‹

- åŸºäºMNISTæ•°æ®é›†ç”Ÿæˆæ‰‹å†™æ•°å­—å›¾ç‰‡
  - keraså®ç°ï¼šmnist_gan.py
  - pytorchå®ç°ï¼šmnist_gan_pytorch.py
    
    è®­ç»ƒè¿‡ç¨‹ä¸­ç”Ÿæˆçš„å›¾ç‰‡è¾“å‡ºåˆ°./mnist_imgsæ–‡ä»¶å¤¹ä¸‹ï¼Œç”Ÿæˆçš„å›¾ç‰‡å¦‚ä¸‹ï¼š
    
    <p>
      <img src="img/mnist_epoch_1.png?raw=true" width="30%">
      <img src="img/mnist_epoch_25.png?raw=true" width="30%">
      <img src="img/mnist_epoch_50.png?raw=true" width="30%">
    </p>
- ç”Ÿæˆé«˜æ–¯åˆ†å¸ƒ
  - keraså®ç°ï¼šsimple_gan.ipynb
  - pytorchå®ç°ï¼šsimple_gan_pytorch.ipynb, gaussian_gan_pytorch.py
    
    gaussian_gan_pytorch.pyè®­ç»ƒç”Ÿæˆçš„åˆ†å¸ƒå›¾å¦‚ä¸‹ï¼š
    <img src="img/gaussian_gan.png?raw=true" width="60%">

## å‚è€ƒèµ„æ–™
[1] https://blog.slinuxer.com/2016/10/generative-adversarial-networks
[2] https://github.com/SwordYork/simplified-deeplearning/tree/master/GAN
[3] Goodfellow I , Pouget-Abadie J , Mirza M ,et al.Generative Adversarial Nets[J].MIT Press, 2014.DOI:10.3156/JSOFT.29.5_177_2.